<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é­”æ³•æ•°å­—å¤©å¹³ Â· æ¯”å¤§å°</title>
  <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #6a89cc;      /* ä¸»è‰²-æ·±è“ç´« */
      --secondary-color: #a3bffa;    /* å‰¯è‰²-æ·¡è“ç´« */
      --accent-color: #7eb6ff;       /* ç‚¹ç¼€-äº®è“ */
      --background-start: #e3eafc;   /* èƒŒæ™¯æ¸å˜èµ·ç‚¹-æ·¡è“ */
      --background-end: #c9d6f2;     /* èƒŒæ™¯æ¸å˜ç»ˆç‚¹-æ·¡è“ç° */
      --text-color: #1a2233;         /* ä¸»æ–‡å­—-æ·±è“ç° */
      --highlight-color: #ffb347;    /* é«˜äº®-äº®æ©™ */
      --plate-color: #c3d0ea;        /* ç›˜å­-åŠ æ·±è“ç° */
      --beam-color: #a3bffa;         /* å¤©å¹³æ†-ä¸»è‰²æ·¡åŒ– */
      --card-bg: #d2e3f7;            /* å¡ç‰‡-åŠ æ·±æ·¡è“ */
      --card-border: #a3bffa;        /* å¡ç‰‡è¾¹æ¡†-ä¸»è‰² */
      --shadow-color: rgba(106,137,204,0.18); /* æŸ”å’Œé˜´å½± */
      --success-color: #43b581;      /* æ›´é¥±å’Œçš„ç»¿ */
      --error-color: #e74c3c;        /* æ›´é¥±å’Œçš„çº¢ */
      --board-radius: 30px;
      --button-radius: 24px;
      --box-shadow: 0 8px 32px 0 rgba(106,137,204,0.18);
      --glow-shadow: 0 0 15px rgba(106,137,204,0.18);
    }

    body {
      background: linear-gradient(135deg, var(--background-start) 0%, var(--background-end) 100%);
      font-family: 'ZCOOL KuaiLe', cursive, sans-serif;
      min-height: 100vh;
      padding: 10px 0;
      margin: 0;
      box-sizing: border-box;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    .main-flex {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: center;
      width: 100%;
      max-width: 1200px;
      gap: 20px;
      max-height: 90vh;
      flex-wrap: nowrap;
    }

    .magic-title {
      font-size: 2.6rem;
      color: var(--text-color);
      text-shadow: 0 0 15px rgba(93, 63, 211, 0.7);
      margin-bottom: 15px;
      letter-spacing: 3px;
      position: relative;
      text-align: center;
    }

    .magic-title::after {
      content: '';
      position: absolute;
      width: 120px;
      height: 4px;
      background: linear-gradient(90deg, transparent, var(--accent-color), transparent);
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 2px;
    }

    .instruction-panel {
      width: 280px;
      padding: 15px 20px;
      margin-left: 0;
      order: 2;
      align-self: flex-start;
      max-height: 320px;
      flex-shrink: 0;
      margin-top: 25px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: var(--box-shadow);
      backdrop-filter: blur(10px);
      color: #111;
      border: 1px solid var(--card-border);
      transition: all 0.3s ease;
      animation: fadeIn 0.5s ease-out;
    }

    .instruction-panel:hover {
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3);
      transform: translateY(-5px);
    }

    .instruction-title {
      font-size: 1.4rem;
      text-align: center;
      margin-bottom: 15px;
      border-bottom: 2px solid rgba(255,255,255,0.3);
      padding-bottom: 10px;
      color: var(--highlight-color);
    }

    .instruction-list {
      font-size: 1.05rem;
      list-style-type: none;
      padding-left: 0;
    }

    .instruction-list li {
      margin-bottom: 10px;
      display: flex;
      align-items: flex-start;
      line-height: 1.5;
    }

    .instruction-list li:before {
      content: "â†’";
      margin-right: 10px;
      color: var(--accent-color);
      font-weight: bold;
    }

    .balance-board {
      flex-grow: 1;
      padding: 25px 25px 25px 25px;
      max-width: 800px;
      margin-right: auto;
      order: 1;
      align-self: flex-start;
      background: var(--card-bg);
      border-radius: var(--board-radius);
      box-shadow: var(--box-shadow);
      backdrop-filter: blur(10px);
      border: 1px solid var(--card-border);
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      transition: all 0.3s ease;
      animation: scaleIn 0.5s ease-out;
      max-height: calc(90vh - 20px);
      overflow-y: auto;
    }

    @keyframes scaleIn {
      0% { transform: scale(0.95); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: translateX(20px); }
      100% { opacity: 1; transform: translateX(0); }
    }

    .magic-balance {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      width: 100%;
      height: 270px;
      margin-bottom: 15px;
      margin-top: -15px;
    }

    .balance-stand {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 30px;
      height: 150px;
      background-color: var(--beam-color);
      z-index: 3;
      border-radius: 5px 5px 0 0;
      box-shadow: inset -5px 0 10px rgba(0,0,0,0.2);
    }

    .balance-pedestal {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 20px;
      background-color: var(--beam-color);
      border-radius: 5px;
      z-index: 2;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .balance-pivot {
      position: absolute;
      top: 140px;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 20px;
      height: 20px;
      background-color: var(--beam-color);
      border-radius: 50%;
      z-index: 5;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }

    .balance-beam-container {
      position: absolute;
      top: 140px;
      left: 50%;
      width: 650px;
      transform-origin: center;
      transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      transform: translateX(-50%) rotate(0deg);
      z-index: 4;
    }

    .balance-beam {
      width: 100%;
      height: 15px;
      background-color: var(--beam-color);
      border-radius: 8px;
      position: relative;
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .balance-beam::before,
    .balance-beam::after {
      content: '';
      position: absolute;
      top: -10px;
      width: 25px;
      height: 10px;
      background-color: var(--beam-color);
      border-radius: 3px;
    }

    .balance-beam::before {
      left: 0;
    }

    .balance-beam::after {
      right: 0;
    }

    .balance-beam-decoration {
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      width: 15px;
      height: 15px;
      background-color: var(--beam-color);
      border-top-left-radius: 50%;
      border-top-right-radius: 50%;
    }

    .plate-container {
      position: absolute;
      top: 0;
      transform-origin: top center;
      transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), top 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .left-plate-container {
      left: 0;
    }

    .right-plate-container {
      right: 0;
    }

    .plate-string {
      width: 2px;
      height: 80px;
      background-color: var(--plate-color);
      z-index: 1;
      margin: 0 auto;
      box-shadow: 1px 0 2px rgba(0,0,0,0.1);
    }

    .magic-plate {
      width: 180px;
      height: 30px;
      background-color: var(--plate-color);
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      position: relative;
      z-index: 2;
      display: flex;
      justify-content: center;
      overflow: visible;
    }

    .plate-items {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-content: flex-end;
      min-height: 80px;
    }

    .magic-creature {
      width: 50px;
      height: 50px;
      margin: 2px;
      border-radius: 50%;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: #fff;
      cursor: grab;
      user-select: none;
      transition: transform 0.2s;
      position: relative;
      z-index: 2;
      background: none;
    }

    .red-bottle {
      background: none;
      filter: drop-shadow(0 0 8px #e74c3c);
    }

    .blue-bottle {
      background: none;
      filter: drop-shadow(0 0 8px #3498db);
    }

    .magic-creature.dragging {
      opacity: 0.5;
      transform: scale(1.1);
    }

    .magic-creature:active {
      transform: scale(1.15) rotate(-8deg);
    }

    .remove-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      background-color: var(--error-color);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 10;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .magic-creature:hover .remove-btn {
      opacity: 1;
    }

    .remove-btn:hover {
      transform: scale(1.2);
    }

    .symbol-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 10px;
      width: 100%;
    }

    .symbol-display {
      width: 80px;
      height: 60px;
      background: rgba(255,255,255,0.2);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: #fff;
      margin-bottom: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      border: 2px dashed rgba(255,255,255,0.3);
      transition: all 0.3s ease;
    }

    .symbol-display:not(:empty) {
      background: rgba(93, 63, 211, 0.3);
      border: 2px solid var(--primary-color);
      box-shadow: var(--glow-shadow);
    }

    .magic-symbols {
      display: flex;
      justify-content: center;
      gap: 30px;
    }

    .magic-symbol {
      font-size: 2.5rem;
      color: var(--text-color);
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      border-radius: 16px;
      padding: 8px 24px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      user-select: none;
    }

    .magic-symbol.selected, .magic-symbol:hover {
      transform: scale(1.15);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4), 0 0 15px rgba(157, 101, 201, 0.6);
      border: 2px solid var(--accent-color);
    }

    .magic-btn {
      margin-top: 0;
      font-size: 1.1rem;
      padding: 10px 25px;
      border-radius: var(--button-radius);
      border: none;
      background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--text-color);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.3s;
      font-family: 'ZCOOL KuaiLe', cursive, sans-serif;
      letter-spacing: 1px;
      position: relative;
      overflow: hidden;
    }

    .magic-btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }

    .magic-btn:hover {
      background: linear-gradient(90deg, var(--secondary-color) 0%, var(--primary-color) 100%);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4), 0 0 15px rgba(157, 101, 201, 0.4);
    }

    .magic-btn:hover::after {
      left: 100%;
    }

    .magic-btn:active {
      transform: translateY(1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .magic-feedback {
      margin-top: 15px;
      font-size: 1.5rem;
      color: #fff;
      text-shadow: 0 0 8px rgba(0, 0, 0, 0.4);
      min-height: 30px;
      letter-spacing: 1px;
      text-align: center;
      transition: all 0.3s ease;
    }

    .creature-pool {
      display: flex;
      flex-wrap: nowrap;
      justify-content: center;
      align-items: center;
      margin: 10px 0 0 0;
      max-width: 700px;
      width: auto;
      background: none;
      backdrop-filter: none;
      padding: 0;
      border-radius: 0;
      border: none;
      min-height: 60px;
      gap: 60px;
    }

    .creature-pool .magic-creature {
      transform: scale(1.2);
      transition: all 0.3s ease;
    }

    .creature-pool .magic-creature:hover {
      transform: scale(1.4);
    }

    .plain-number {
      position: absolute;
      color: var(--text-color);
      font-size: 2.6rem;
      font-weight: bold;
      left: 0;
      right: 0;
      margin: 0 auto;
      text-align: center;
      z-index: 20;
      pointer-events: auto;
      background: transparent !important;
      box-shadow: none;
      border-radius: 0;
      top: 45px;
      width: 80px;
      cursor: pointer;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      transition: all 0.3s ease;
    }

    #left-number {
      left: 70px;
      right: auto;
      top: 45px;
    }

    #right-number {
      right: 70px;
      left: auto;
      top: 45px;
    }

    @media (max-width: 900px) {
      .main-flex {
        flex-direction: column-reverse;
        align-items: center;
        gap: 15px;
      }
      .instruction-panel {
        width: 90%;
        margin: 0 auto;
        order: 2;
      }
      .balance-board {
        max-width: 90%;
        order: 1;
        margin: 0 auto;
      }
    }

    @media (max-width: 700px) {
      body {
        padding: 5px 0;
      }
      .magic-title {
        font-size: 2rem;
        margin-bottom: 10px;
      }
      .magic-balance {
        height: 250px;
      }
      .balance-board {
        padding: 15px 4px 15px 4px;
      }
      .magic-creature { width: 40px; height: 40px; font-size: 1.8rem; }
      .magic-symbol { font-size: 1.5rem; padding: 4px 10px; }
      .magic-number { font-size: 1.8rem; width: 40px; height: 40px; }
      .symbol-display { width: 60px; height: 40px; font-size: 1.8rem; }
      .plate-items { grid-template-columns: repeat(4, 32px); grid-auto-rows: 32px; min-height: 64px; }
    }

    .energy-bar {
      background: none !important;
      border: none !important;
      box-shadow: none !important;
      border-radius: 0 !important;
      color: #111 !important;
      padding: 0 !important;
      margin-bottom: 5px;
      font-size: 1.6rem;
      font-weight: bold;
      left: 0;
      transform: none;
      display: block;
    }

    #energy-count {
      display: inline-block;
      min-width: 30px;
      text-align: center;
      padding: 2px 8px;
      background: rgba(255, 209, 102, 0.2);
      border-radius: 12px;
      transition: all 0.3s ease;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-top: 15px;
      margin-bottom: 0;
    }

    .answer-tip {
      margin-top: 15px;
      font-size: 1.1rem;
      color: var(--highlight-color);
      background: rgba(52, 73, 94, 0.8);
      border-radius: 15px;
      padding: 12px 25px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      letter-spacing: 1px;
      min-height: 28px;
      max-width: 85%;
      border-left: 3px solid var(--highlight-color);
      animation: fadeIn 0.5s ease;
    }

    .editable-number {
      border-bottom: 2px dashed var(--highlight-color);
      transition: all 0.3s ease;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { opacity: 1; text-shadow: 0 0 10px rgba(255, 209, 102, 0.2); }
      50% { opacity: 0.8; text-shadow: 0 0 15px rgba(255, 209, 102, 0.7); }
      100% { opacity: 1; text-shadow: 0 0 10px rgba(255, 209, 102, 0.2); }
    }

    .editable-number:hover {
      background: rgba(255, 224, 102, 0.3);
      transform: scale(1.15);
      border-radius: 10px;
      padding: 0 5px;
    }

    .plain-number input {
      width: 60px;
      font-size: 2.2rem;
      font-weight: bold;
      text-align: center;
      border: 2px solid var(--highlight-color);
      border-radius: 12px;
      outline: none;
      background: #fff !important;
      color: var(--text-color) !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      padding: 4px;
      font-family: 'ZCOOL KuaiLe', cursive, sans-serif;
    }

    /* æ­£ç¡®ç­”æ¡ˆæ¼”ç¤ºæ ·å¼ */
    .demo-plate {
      position: relative;
      width: 180px;
      height: 120px;
      margin: 10px auto;
      display: flex;
      justify-content: center;
      align-items: flex-end;
    }

    .demo-container {
      display: flex;
      justify-content: space-around;
      width: 100%;
      margin-top: 20px;
      animation: fadeIn 0.5s ease;
    }

    .demo-side {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgba(255,255,255,0.1);
      border-radius: 15px;
      padding: 15px;
      width: 45%;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      border: 1px solid rgba(255,255,255,0.1);
    }

    .demo-side:hover {
      box-shadow: 0 8px 25px rgba(0,0,0,0.25);
      background: rgba(255,255,255,0.15);
      transform: translateY(-5px);
    }

    .demo-title {
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: var(--highlight-color);
      text-shadow: 0 0 8px rgba(0,0,0,0.3);
    }

    /* ç„¦ç‚¹å…ƒç´  */
    .focused {
      animation: focus-glow 2s infinite;
    }

    @keyframes focus-glow {
      0% { box-shadow: 0 0 5px rgba(255, 126, 219, 0.5); }
      50% { box-shadow: 0 0 20px rgba(255, 126, 219, 0.8); }
      100% { box-shadow: 0 0 5px rgba(255, 126, 219, 0.5); }
    }

    /* å¢åŠ æ­£ç¡®å’Œé”™è¯¯çš„åé¦ˆæ•ˆæœ */
    .feedback-correct {
      color: var(--success-color) !important;
      text-shadow: 0 0 10px rgba(102, 255, 178, 0.5) !important;
    }

    .feedback-error {
      color: var(--error-color) !important;
      text-shadow: 0 0 10px rgba(255, 107, 107, 0.5) !important;
    }

    /* æ·»åŠ é¢œè‰²æç¤ºæ ·å¼ */
    .plate-label {
      position: absolute;
      top: -25px;
      font-size: 1.1rem;
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.4);
      padding: 2px 8px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .left-plate-label {
      left: 20px;
      border-left: 3px solid #e74c3c;
    }

    .right-plate-label {
      right: 20px;
      border-left: 3px solid #3498db;
    }
  </style>
</head>
<body>
  <div class="magic-title">é­”æ³•æ•°å­—å¤©å¹³ Â· æ¯”å¤§å°</div>
  <div class="main-flex">
    <div class="balance-board">
      <div class="energy-bar" id="energy-bar">é­”æ³•èƒ½é‡ï¼š<span id="energy-count">0</span></div>
      <div class="magic-balance">
        <!-- å·¦æ•°å­— -->
        <div class="plain-number editable-number" id="left-number">3</div>
        <!-- å³æ•°å­— -->
        <div class="plain-number editable-number" id="right-number">5</div>
        <!-- å¤©å¹³æ”¯æ¶ -->
        <div class="balance-stand"></div>
        <div class="balance-pedestal"></div>
        <!-- å¤©å¹³æ† -->
        <div class="balance-beam-container" id="balance-beam">
          <div class="balance-beam">
            <div class="balance-beam-decoration"></div>
          </div>
          <!-- å·¦ç›˜ -->
          <div class="plate-container left-plate-container" id="left-container">
            <div class="plate-string"></div>
            <div class="magic-plate">
              <div class="plate-items" id="left-plate"></div>
            </div>
          </div>
          <!-- å³ç›˜ -->
          <div class="plate-container right-plate-container" id="right-container">
            <div class="plate-string"></div>
            <div class="magic-plate">
              <div class="plate-items" id="right-plate"></div>
            </div>
          </div>
        </div>
        <div class="balance-pivot"></div>
      </div>
      <div class="creature-pool" id="creature-pool"></div>
      <div class="symbol-container">
        <div class="symbol-display" id="symbol-display"></div>
        <div class="magic-symbols">
          <div class="magic-symbol" data-symbol=">">&gt;</div>
          <div class="magic-symbol" data-symbol="=">=</div>
          <div class="magic-symbol" data-symbol="<">&lt;</div>
        </div>
      </div>
      <div class="btn-row">
        <button class="magic-btn" id="next-btn">ä¸‹ä¸€é¢˜</button>
        <button class="magic-btn" id="reset-btn">é‡ç½®</button>
        <button class="magic-btn" id="check-btn">æäº¤ç­”æ¡ˆ</button>
        <button class="magic-btn" id="show-answer-btn" style="display:none;">æŸ¥çœ‹æ­£ç¡®ç­”æ¡ˆ</button>
      </div>
      <div class="magic-feedback" id="feedback"></div>
      <div class="answer-tip" id="answer-tip" style="display:none;"></div>
      <div class="demo-container" id="demo-container" style="display:none;">
        <div class="demo-side">
          <div class="demo-title">å·¦ç›˜</div>
          <div class="demo-plate" id="demo-left"></div>
        </div>
        <div class="demo-side">
          <div class="demo-title">å³ç›˜</div>
          <div class="demo-plate" id="demo-right"></div>
        </div>
      </div>
    </div>
    <div class="instruction-panel">
      <div class="instruction-title">æ“ä½œè¯´æ˜</div>
      <ul class="instruction-list">
        <li>æ‹–åŠ¨ä¸‹æ–¹çº¢è‰²è¯æ°´ç“¶åˆ°å·¦ç›˜ï¼Œè“è‰²è¯æ°´ç“¶åˆ°å³ç›˜</li>
        <li>æ¯è¾¹æ”¾ç½®çš„è¯æ°´ç“¶æ•°é‡éœ€ç­‰äºå¤©å¹³ä¸Šæ–¹æ˜¾ç¤ºçš„æ•°å­—</li>
        <li>é€‰æ‹©æ­£ç¡®çš„æ¯”è¾ƒç¬¦å·ï¼ˆ&lt;ã€=ã€&gt;ï¼‰</li>
        <li>ç‚¹å‡»"æäº¤ç­”æ¡ˆ"æ£€æŸ¥ç»“æœ</li>
        <li>è¯æ°´ç“¶å¯ä»¥ä»å¤©å¹³ä¸Šç§»é™¤æˆ–æ‹–åˆ°å¦ä¸€ä¾§</li>
        <li>ç‚¹å‡»å¤©å¹³ä¸Šæ–¹çš„æ•°å­—å¯ä»¥ä¿®æ”¹æ•°å€¼</li>
      </ul>
    </div>
  </div>
  <script>
    let hasShowAnswer = false; // æ˜¯å¦å·²æŸ¥çœ‹ç­”æ¡ˆ
    // ç‰©å“æ åªæ˜¾ç¤ºçº¢è‰²è¯æ°´ç“¶å’Œè“è‰²è¯æ°´ç“¶å„ä¸€ä¸ªï¼Œå¯ä»¥æ— é™æ¬¡æ‹–æ‹½
    const creatures = [
      { type: 'red', emoji: 'ğŸ§ª' },
      { type: 'blue', emoji: 'ğŸ§´' }
    ];
    let leftTarget = 0, rightTarget = 0, selectedSymbol = null;
    let leftItems = [], rightItems = [];
    const creaturePool = document.getElementById('creature-pool');
    const leftPlate = document.getElementById('left-plate');
    const rightPlate = document.getElementById('right-plate');
    const symbolDisplay = document.getElementById('symbol-display');
    const balanceBeam = document.getElementById('balance-beam');
    const leftContainer = document.getElementById('left-container');
    const rightContainer = document.getElementById('right-container');
    const demoLeft = document.getElementById('demo-left');
    const demoRight = document.getElementById('demo-right');
    const demoContainer = document.getElementById('demo-container');
    let draggedType = null;

    const perRow = 4;

    function randomNum() {
      return Math.floor(Math.random() * 9) + 1; // 1~9
    }

    function updateBalancePosition() {
      const difference = leftItems.length - rightItems.length;
      const maxTilt = 10;
      let tiltAngle = Math.min(Math.abs(difference) * 2, maxTilt);
      if (difference > 0) tiltAngle = -tiltAngle;
      balanceBeam.style.transform = `translateX(-50%) rotate(${tiltAngle}deg)`;
      if (tiltAngle !== 0) {
        leftContainer.style.transform = `rotate(${-tiltAngle}deg)`;
        rightContainer.style.transform = `rotate(${-tiltAngle}deg)`;
        const beamHalfWidth = balanceBeam.clientWidth / 2;
        const angleRad = Math.abs(tiltAngle) * (Math.PI / 180);
        const verticalOffset = Math.sin(angleRad) * beamHalfWidth * 0.15;
        if (tiltAngle < 0) {
          leftContainer.style.top = `${verticalOffset}px`;
          rightContainer.style.top = `${-verticalOffset}px`;
        } else {
          leftContainer.style.top = `${-verticalOffset}px`;
          rightContainer.style.top = `${verticalOffset}px`;
        }
      } else {
        leftContainer.style.transform = 'rotate(0deg)';
        rightContainer.style.transform = 'rotate(0deg)';
        leftContainer.style.top = '0px';
        rightContainer.style.top = '0px';
      }
    }

    function createDraggableCreature(type, emoji) {
      const el = document.createElement('div');
      el.className = 'magic-creature';
      if (type === 'red') {
        el.classList.add('red-bottle');
      } else {
        el.classList.add('blue-bottle');
      }
      el.draggable = true;
      el.dataset.type = type;
      el.innerText = emoji;
      el.addEventListener('dragstart', function(e) {
        draggedType = type;
        el.classList.add('dragging');
        e.dataTransfer.setData('text/plain', type);
        e.dataTransfer.effectAllowed = 'copy';
      });
      el.addEventListener('dragend', function(e) {
        el.classList.remove('dragging');
      });
      return el;
    }

    // è‡ªåŠ¨è¡¥é½åº•å±‚ç©ºä½
    function addItemToPlate(items, type, emoji) {
      items.push({type, emoji});
    }

    function addRemoveButton(creature, isLeft, idx) {
      const removeBtn = document.createElement('div');
      removeBtn.className = 'remove-btn';
      removeBtn.innerHTML = 'âœ•';
      removeBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        if (isLeft) {
          leftItems.splice(idx, 1);
          renderPlate(leftPlate, leftItems, true);
        } else {
          rightItems.splice(idx, 1);
          renderPlate(rightPlate, rightItems, false);
        }
        updateBalancePosition();
      });
      creature.appendChild(removeBtn);
    }

    function renderPlate(plate, items, isLeft) {
      plate.innerHTML = '';
      if (items.length === 0) return;

      const itemsPerRow = 4;
      const verticalGap = 38; // å±‚é—´è·
      const horizontalGap = 48; // åˆ—é—´è·
      const plateCenter = 90;

      for (let i = 0; i < items.length; i++) {
        const item = items[i];
        const row = Math.floor(i / itemsPerRow);
        const col = i % itemsPerRow;
        const el = createDraggableCreature(item.type, item.emoji);
        el.style.position = 'absolute';
        el.style.bottom = `${row * verticalGap}px`;
        el.style.left = `${(col - Math.floor(itemsPerRow/2)) * horizontalGap + plateCenter}px`;
        el.style.zIndex = row + 1;
        addRemoveButton(el, isLeft, i);
        plate.appendChild(el);
      }
    }

    function setupDropZone(element, isLeft) {
      element.addEventListener('dragover', function(e) {
        e.preventDefault();
        // æ£€æŸ¥è¯æ°´ç“¶ç±»å‹æ˜¯å¦ç¬¦åˆè§„åˆ™
        const allowedType = isLeft ? 'red' : 'blue';
        if (draggedType === allowedType) {
          e.dataTransfer.dropEffect = 'copy';
          element.classList.add('drop-allowed');
        } else {
          e.dataTransfer.dropEffect = 'none';
          element.classList.add('drop-denied');
        }
      });

      element.addEventListener('dragleave', function(e) {
        element.classList.remove('drop-allowed');
        element.classList.remove('drop-denied');
      });

      element.addEventListener('drop', function(e) {
        e.preventDefault();
        element.classList.remove('drop-allowed');
        element.classList.remove('drop-denied');

        // ç¡®ä¿åªæœ‰æ­£ç¡®çš„è¯æ°´ç“¶é¢œè‰²æ‰èƒ½æ”¾ç½®
        const allowedType = isLeft ? 'red' : 'blue';
        if (draggedType === allowedType) {
          const c = creatures.find(c => c.type === draggedType);
          if (isLeft) {
            addItemToPlate(leftItems, c.type, c.emoji);
            renderPlate(leftPlate, leftItems, true);
          } else {
            addItemToPlate(rightItems, c.type, c.emoji);
            renderPlate(rightPlate, rightItems, false);
          }
          updateBalancePosition();
        } else {
          // å¦‚æœæ”¾é”™é¢œè‰²ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
          const feedback = document.getElementById('feedback');
          feedback.textContent = isLeft ? 'å·¦è¾¹åªèƒ½æ”¾çº¢è‰²è¯æ°´ç“¶ï¼' : 'å³è¾¹åªèƒ½æ”¾è“è‰²è¯æ°´ç“¶ï¼';
          feedback.style.color = '#e74c3c';
          setTimeout(() => { feedback.textContent = ''; }, 2000);
        }
      });
    }

    function createCreaturePool() {
      creaturePool.innerHTML = '';
      creatures.forEach(c => {
        const el = createDraggableCreature(c.type, c.emoji);
        creaturePool.appendChild(el);
      });
    }

    function createDemoCreature(type, emoji, index) {
      const el = document.createElement('div');
      el.className = 'magic-creature';
      if (type === 'red') {
        el.classList.add('red-bottle');
      } else {
        el.classList.add('blue-bottle');
      }
      el.innerText = emoji;

      // è®¡ç®—ä½ç½® - ç®€å•æ’åˆ—
      const itemsPerRow = 4;
      const row = Math.floor(index / itemsPerRow);
      const col = index % itemsPerRow;

      el.style.position = 'absolute';
      el.style.bottom = `${row * 36}px`;
      el.style.left = `${col * 40 + 10}px`;

      return el;
    }

    let errorCount = 0;
    let energy = 0;
    function updateEnergyBar() {
      document.getElementById('energy-count').textContent = energy;
    }
    function showAnswer() {
      hasShowAnswer = true;
      // 1. ç›´æ¥ä»é¡µé¢è¯»å–å½“å‰æ•°å­—ï¼Œé˜²æ­¢å˜é‡è¢«æ„å¤–æ¸…ç©º
      const leftNum = parseInt(document.getElementById('left-number').textContent);
      const rightNum = parseInt(document.getElementById('right-number').textContent);
      let symbol = '=';
      if (leftNum > rightNum) symbol = '>';
      if (leftNum < rightNum) symbol = '<';
      document.getElementById('answer-tip').style.display = '';
      document.getElementById('answer-tip').textContent = `æ­£ç¡®ç­”æ¡ˆï¼šå·¦è¾¹æ”¾${leftNum}ä¸ªçº¢è‰²è¯æ°´ç“¶ï¼Œå³è¾¹æ”¾${rightNum}ä¸ªè“è‰²è¯æ°´ç“¶ï¼Œç¬¦å·åº”ä¸º"${symbol}"`;

      // 2. ç›´æ¥åœ¨ä¸»å¤©å¹³ä¸Šå¡«å…¥æ­£ç¡®æ•°é‡çš„ç‰©å“
      leftItems = [];
      rightItems = [];
      for (let i = 0; i < leftNum; i++) {
        leftItems.push({type: 'red', emoji: creatures[0].emoji});
      }
      for (let i = 0; i < rightNum; i++) {
        rightItems.push({type: 'blue', emoji: creatures[1].emoji});
      }
      renderPlate(leftPlate, leftItems, true);
      renderPlate(rightPlate, rightItems, false);
      updateBalancePosition();

      // 3. è‡ªåŠ¨é€‰ä¸­æ­£ç¡®ç¬¦å·
      document.querySelectorAll('.magic-symbol').forEach(el => {
        if (el.getAttribute('data-symbol') === symbol) {
          el.classList.add('selected');
        } else {
          el.classList.remove('selected');
        }
      });
      selectedSymbol = symbol;
      symbolDisplay.textContent = symbol;
    }

    function hideAnswer() {
      document.getElementById('answer-tip').style.display = 'none';
      demoContainer.style.display = 'none';
      document.querySelectorAll('.magic-symbol').forEach(el => el.classList.remove('selected'));
      symbolDisplay.textContent = '';
    }

    function resetGame(isNext = false) {
      if (!isNext) energy = 0;
      if (isNext) {
        leftTarget = randomNum();
        rightTarget = randomNum();
        document.getElementById('left-number').textContent = leftTarget;
        document.getElementById('right-number').textContent = rightTarget;
      }
      leftItems = [];
      rightItems = [];
      renderPlate(leftPlate, leftItems, true);
      renderPlate(rightPlate, rightItems, false);
      selectedSymbol = null;
      symbolDisplay.textContent = '';
      document.querySelectorAll('.magic-symbol').forEach(el => el.classList.remove('selected'));
      document.getElementById('feedback').textContent = '';
      document.getElementById('feedback').style.color = '#fff';
      balanceBeam.style.transform = 'translateX(-50%) rotate(0deg)';
      leftContainer.style.transform = 'rotate(0deg)';
      rightContainer.style.transform = 'rotate(0deg)';
      leftContainer.style.top = '0px';
      rightContainer.style.top = '0px';
      createCreaturePool();
      errorCount = 0;
      hasShowAnswer = false;
      // åªæœ‰ç‚¹å‡»ä¸‹ä¸€é¢˜æ‰éšè—æŸ¥çœ‹ç­”æ¡ˆæŒ‰é’®
      if (isNext) {
        document.getElementById('show-answer-btn').style.display = 'none';
        document.getElementById('answer-tip').style.display = 'none';
      }
      hideAnswer();
      updateEnergyBar();
    }

    function nextGame() {
      resetGame(true);
    }

    document.getElementById('reset-btn').onclick = function() {
      // é‡ç½®æ—¶ä¸æ”¹å˜å·¦å³çš„ç›®æ ‡æ•°å­—ï¼Œåªæ¸…ç©ºç›˜å­
      leftItems = [];
      rightItems = [];
      renderPlate(leftPlate, leftItems, true);
      renderPlate(rightPlate, rightItems, false);
      selectedSymbol = null;
      symbolDisplay.textContent = '';
      document.querySelectorAll('.magic-symbol').forEach(el => el.classList.remove('selected'));
      document.getElementById('feedback').textContent = '';
      document.getElementById('feedback').style.color = '#fff';
      balanceBeam.style.transform = 'translateX(-50%) rotate(0deg)';
      leftContainer.style.transform = 'rotate(0deg)';
      rightContainer.style.transform = 'rotate(0deg)';
      leftContainer.style.top = '0px';
      rightContainer.style.top = '0px';
      createCreaturePool();
      errorCount = 0;
      document.getElementById('show-answer-btn').style.display = 'none';
      hideAnswer();
      updateEnergyBar();
    }

    document.getElementById('next-btn').onclick = function() {
      nextGame();
    }

    document.getElementById('show-answer-btn').onclick = function() {
      showAnswer();
      // ä¿æŒæŒ‰é’®å¯è§ï¼Œä¸éšè—
    }

    document.getElementById('check-btn').onclick = function() {
      const leftTargetNum = parseInt(document.getElementById('left-number').textContent);
      const rightTargetNum = parseInt(document.getElementById('right-number').textContent);
      if (!selectedSymbol) {
        document.getElementById('feedback').textContent = 'è¯·é€‰æ‹©ä¸€ä¸ªç¬¦å·ï¼';
        document.getElementById('feedback').style.color = '#fff';
        setTimeout(() => { document.getElementById('feedback').textContent = ''; }, 2000);
        return;
      }

      // æ£€æŸ¥å·¦ä¾§æ˜¯å¦éƒ½æ˜¯çº¢è‰²è¯æ°´ç“¶
      const allRedOnLeft = leftItems.every(item => item.type === 'red');
      // æ£€æŸ¥å³ä¾§æ˜¯å¦éƒ½æ˜¯è“è‰²è¯æ°´ç“¶
      const allBlueOnRight = rightItems.every(item => item.type === 'blue');

      if (!allRedOnLeft || !allBlueOnRight) {
        document.getElementById('feedback').textContent = 'å·¦è¾¹åªèƒ½æ”¾çº¢è‰²è¯æ°´ç“¶ï¼Œå³è¾¹åªèƒ½æ”¾è“è‰²è¯æ°´ç“¶ï¼';
        document.getElementById('feedback').style.color = '#e74c3c';
        setTimeout(() => { document.getElementById('feedback').textContent = ''; }, 2000);
        return;
      }

      if (leftItems.length !== leftTargetNum || rightItems.length !== rightTargetNum) {
        document.getElementById('feedback').textContent = 'è¯·æ”¾ç½®æ­£ç¡®æ•°é‡çš„ç‰©å“ï¼';
        document.getElementById('feedback').style.color = '#fff';
        errorCount++;
        if (errorCount >= 3) {
          document.getElementById('show-answer-btn').style.display = 'inline-block';
        }
        setTimeout(() => { document.getElementById('feedback').textContent = ''; }, 2000);
        return;
      }
      let correct = false;
      if (selectedSymbol === '>') correct = leftTargetNum > rightTargetNum;
      if (selectedSymbol === '<') correct = leftTargetNum < rightTargetNum;
      if (selectedSymbol === '=') correct = leftTargetNum === rightTargetNum;
      if (correct) {
        if (hasShowAnswer) {
          document.getElementById('feedback').textContent = 'âœ¨ç­”å¯¹å•¦ï¼';
          document.getElementById('feedback').style.color = '#ffe066';
        } else {
          document.getElementById('feedback').textContent = 'âœ¨ç­”å¯¹å•¦ï¼é­”æ³•èƒ½é‡+1âœ¨';
          document.getElementById('feedback').style.color = '#ffe066';
          energy++;
          updateEnergyBar();
        }
        setTimeout(() => { document.getElementById('feedback').textContent = ''; }, 2000);
        setTimeout(() => {
          nextGame();
        }, 1200);
      } else {
        errorCount++;
        document.getElementById('feedback').textContent = `âŒå†è¯•ä¸€æ¬¡å§ï¼ï¼ˆ${errorCount}/3ï¼‰`;
        document.getElementById('feedback').style.color = '#e74c3c';
        if (errorCount >= 3) {
          document.getElementById('show-answer-btn').style.display = 'inline-block';
        }
        setTimeout(() => { document.getElementById('feedback').textContent = ''; }, 2000);
      }
    }

    // æ·»åŠ è¯´æ˜æ ‡ç­¾
    function addPlateLabels() {
      const leftLabel = document.createElement('div');
      leftLabel.className = 'plate-label left-plate-label';
      leftLabel.textContent = 'çº¢è‰²è¯æ°´åŒº';
      leftContainer.appendChild(leftLabel);

      const rightLabel = document.createElement('div');
      rightLabel.className = 'plate-label right-plate-label';
      rightLabel.textContent = 'è“è‰²è¯æ°´åŒº';
      rightContainer.appendChild(rightLabel);
    }

    setupDropZone(leftPlate, true);
    setupDropZone(rightPlate, false);
    resetGame();
    addPlateLabels();

    // ç»‘å®šç¬¦å·é€‰æ‹©ç‚¹å‡»äº‹ä»¶
    document.querySelectorAll('.magic-symbol').forEach(el => {
      el.onclick = function() {
        document.querySelectorAll('.magic-symbol').forEach(e => e.classList.remove('selected'));
        el.classList.add('selected');
        selectedSymbol = el.getAttribute('data-symbol');
        symbolDisplay.textContent = el.textContent;
      }
    });

    // æ•°å­—å¯ç¼–è¾‘
    function makeNumberEditable(id, side) {
      const el = document.getElementById(id);
      el.removeEventListener('click', handleNumberClick); // ç§»é™¤ä¹‹å‰å¯èƒ½å­˜åœ¨çš„äº‹ä»¶ç›‘å¬

      function handleNumberClick() {
        if (el.querySelector('input')) return;

        // è·å–å½“å‰å€¼
        const oldValue = side === 'left' ? leftTarget : rightTarget;

        // åˆ›å»ºè¾“å…¥æ¡†
        const input = document.createElement('input');
        input.type = 'number';
        input.min = 1;
        input.max = 9;
        input.value = oldValue;

        // æ¸…ç©ºå…ƒç´ å¹¶æ·»åŠ è¾“å…¥æ¡†
        el.textContent = '';
        el.appendChild(input);

        // èšç„¦å¹¶é€‰ä¸­å…¨éƒ¨æ–‡æœ¬
        input.focus();
        input.select();

        // ä¿å­˜å‡½æ•°
        function save() {
          let v = parseInt(input.value);
          if (isNaN(v) || v < 1 || v > 9) {
            v = oldValue;
          }

          // æ›´æ–°ç›®æ ‡å€¼
          if (side === 'left') leftTarget = v;
          else rightTarget = v;

          // æ›´æ–°æ˜¾ç¤º
          el.textContent = v;

          // é‡ç½®æ¸¸æˆçŠ¶æ€
          leftItems = [];
          rightItems = [];
          renderPlate(leftPlate, leftItems, true);
          renderPlate(rightPlate, rightItems, false);
          selectedSymbol = null;
          symbolDisplay.textContent = '';
          document.querySelectorAll('.magic-symbol').forEach(e => e.classList.remove('selected'));
          document.getElementById('feedback').textContent = '';
          document.getElementById('feedback').style.color = '#fff';
          balanceBeam.style.transform = 'translateX(-50%) rotate(0deg)';
          leftContainer.style.transform = 'rotate(0deg)';
          rightContainer.style.transform = 'rotate(0deg)';
          leftContainer.style.top = '0px';
          rightContainer.style.top = '0px';
          createCreaturePool();
          // ä¿ç•™é”™è¯¯è®¡æ•°ï¼Œä¸å†é‡ç½®
          document.getElementById('show-answer-btn').style.display = 'none';
          hideAnswer();
        }

        // æ·»åŠ äº‹ä»¶ç›‘å¬
        input.addEventListener('blur', save);
        input.addEventListener('keydown', function(e) {
          if (e.key === 'Enter') {
            input.blur();
          } else if (e.key === 'Escape') {
            el.textContent = oldValue;
            input.removeEventListener('blur', save);
          }
        });
      }

      el.addEventListener('click', handleNumberClick);
    }

    makeNumberEditable('left-number', 'left');
    makeNumberEditable('right-number', 'right');
  </script>
</body>
</html>